#!/usr/bin/env bash

URL="https://calendar.google.com"
URL+="/calendar/ical"
URL+="/ppj8u127fg7b5nvqkdq3nr87o0%40group.calendar.google.com"
URL+="/private"
URL+="-52032d4919b1be7bba8587fe59890bd6/basic.ics"

FILE=/var/dance/calendar.ics      # Location of the calendar file
TEMP=/var/dance/tmp/calendar.ics  # Location of the temporary download

if curl --fail --silent --location --retry 120 --retry-delay 1 -o "$TEMP" "$URL"
then
  mv "$TEMP" "$FILE"
else
  echo >&2 "Failed to download the dance calendar"
  exit 1
fi
